<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>CPU Scheduling Visualizer</title>
  <link rel="stylesheet" href="style.css" />
</head>

<body>
  <div class="container">

    <!-- ==================== HEADER ==================== -->
    <header class="header">
      <h1>CPU Scheduler Visualizer</h1>
      <p>Understand CPU Scheduling Algorithms Through Intuitive Visualization</p>
    </header>

    <div class="main-content">

      <!-- ==================== LEFT PANEL ==================== -->
      <aside class="left-panel">

        <!-- Algorithm Selection -->
        <section class="card">
          <h2>Algorithm</h2>
          <!-- Algorithm dropdown with info button -->
          <div style="display: flex; align-items: center; gap: 8px;">
            <select id="algorithmSelect" class="form-select" style="flex: 1; margin-bottom: 0;">
              <option value="FCFS">FCFS - First Come First Served</option>
              <option value="SJF">SJF - Shortest Job First (Non-Preemptive)</option>
              <option value="SRTF">SRTF - Shortest Remaining Time First</option>
              <option value="Priority">Priority Scheduling</option>
              <option value="RoundRobin">Round Robin</option>
            </select>
            <!-- Info button to show algorithm description -->
            <button id="algoInfoBtn" class="info-btn" title="Algorithm Information">i</button>
          </div>

          <!-- Time Quantum input (shown only for Round Robin) -->
          <div id="timeQuantumCard" class="mt" style="display:none;">
            <label class="form-label">Time Quantum (TQ)</label>
            <input id="timeQuantum" type="number" class="form-input" value="2" min="1" />
          </div>
        </section>

        <!-- Tab Selection: Manual Entry vs Upload Table -->
        <section class="card">
          <div class="tab-container">
            <button class="tab-btn active" data-tab="manual">Manual Entry</button>
            <button class="tab-btn" data-tab="upload">Upload Table</button>
          </div>

          <!-- ========== MANUAL ENTRY TAB ========== -->
          <div id="manualTab" class="tab-content active">
            <h2 style="margin-top: 15px;">Add Process</h2>

            <label class="form-label">Process ID</label>
            <input id="processId" class="form-input" placeholder="e.g., P1" />

            <!-- Arrival and Burst Time in two columns -->
            <div class="two-cols mt">
              <div>
                <label class="form-label">Arrival Time</label>
                <input id="arrivalTime" class="form-input" type="number" value="0" />
              </div>
              <div>
                <label class="form-label">Burst Time</label>
                <input id="burstTime" class="form-input" type="number" value="1" min="1" />
              </div>
            </div>

            <!-- Priority input (shown only for Priority Scheduling) -->
            <label id="priorityLabel" class="form-label mt" style="display:none;">Priority (lower = higher)</label>
            <input id="priority" class="form-input" type="number" value="1" min="1" style="display:none;" />

            <button id="addBtn" class="btn btn-success mt">+ Add Process</button>
          </div>

          <!-- ========== UPLOAD TABLE TAB ========== -->
          <div id="uploadTab" class="tab-content">
            <h2 style="margin-top: 15px;">Upload Table</h2>
            
            <!-- Drag & drop upload area -->
            <div class="upload-area" id="uploadArea">
              <div class="upload-icon">üìÅ</div>
              <p class="upload-text">Click to upload or drag & drop</p>
              <p class="upload-subtext">Supports CSV and Excel files (.csv, .xlsx, .xls)</p>
              <input type="file" id="fileInput" accept=".csv,.xlsx,.xls" style="display: none;" />
            </div>

            <!-- Download sample template button -->
            <button id="downloadTemplate" class="btn btn-secondary mt">
              üì• Download Sample Template
            </button>

            <!-- Format information -->
            <div class="upload-info mt">
              <p class="info-title">Expected Format:</p>
              <div class="info-box">
                <code>Process, ArrivalTime, BurstTime, Priority</code>
                <code>P1, 0, 5, 2</code>
                <code>P2, 1, 3, 1</code>
              </div>
              <p class="info-note">* Priority column is optional (only for Priority Scheduling)</p>
            </div>
          </div>
        </section>

        <!-- Processes List -->
        <section class="card processes-card">
          <h2>Processes List</h2>
          <div id="processList" class="process-list"></div>
          <button id="clearAllBtn" class="btn btn-danger mt" style="display:none;">üóë Clear All</button>
        </section>

        <!-- Control Buttons -->
        <section class="card">
          <h2>Controls</h2>
          <div class="button-group">
            <button id="runBtn" class="btn btn-primary">‚ñ∂ Run</button>
            <button id="resetBtn" class="btn btn-secondary">‚Üª Reset</button>
          </div>
        </section>

      </aside>

      <!-- ==================== RIGHT PANEL ==================== -->
      <main class="right-panel">

        <!-- Gantt Chart Visualization -->
        <section class="card gantt-card">
          <h2>Gantt Chart</h2>
          <div id="ganttContainer" class="gantt-container">
            <!-- Placeholder shown before running scheduler -->
            <div id="ganttPlaceholder" class="gantt-placeholder">
              <table class="empty-grid">
                <tbody>
                  <tr><td></td><td></td><td></td><td></td><td></td></tr>
                  <tr><td></td><td></td><td></td><td></td><td></td></tr>
                  <tr><td></td><td></td><td></td><td></td><td></td></tr>
                </tbody>
              </table>
              <p class="placeholder-note">Run the scheduler to generate the Gantt chart.</p>
            </div>
          </div>
        </section>

        <!-- Process Execution Details Table -->
        <section class="card full-width">
          <h2>Process Execution Details</h2>
          <div id="executionDetails" class="execution-table-container">
            <p class="placeholder-text">Execute scheduler to see process execution details</p>
          </div>
        </section>

        <!-- Performance Metrics -->
        <section class="card metrics-panel">
          <h2>Metrics</h2>

          <div class="metrics-grid">

            <!-- CPU Utilization (Circular Progress) -->
            <div class="metric cardio">
              <div class="metric-title">CPU Utilization</div>
              <div class="cpu-ring-wrap">
                <svg id="cpuRing" class="cpu-ring" width="110" height="110" viewBox="0 0 110 110">
                  <circle class="ring-bg" cx="55" cy="55" r="45" stroke-width="10" fill="none"/>
                  <circle id="cpuProgress" class="ring-progress"
                          cx="55" cy="55" r="45" stroke-width="10"
                          stroke-linecap="round" fill="none"
                          transform="rotate(-90 55 55)" />
                </svg>
                <div class="cpu-label"><span id="cpuPercent">0%</span></div>
              </div>
            </div>

            <!-- Average Waiting Time -->
            <div class="metric glass">
              <div class="metric-title">Avg Waiting Time</div>
              <div class="glass-body">
                <div class="glass-progress-bar">
                  <div id="avgWaitBar" class="glass-progress-fill"></div>
                </div>
                <div class="glass-number"><span id="avgWait">0.00</span> ms</div>
              </div>
            </div>

            <!-- Average Turnaround Time -->
            <div class="metric glass">
              <div class="metric-title">Avg Turnaround Time</div>
              <div class="glass-body">
                <div class="glass-progress-bar">
                  <div id="avgTurnBar" class="glass-progress-fill"></div>
                </div>
                <div class="glass-number"><span id="avgTurnaround">0.00</span> ms</div>
              </div>
            </div>

            <!-- Average Response Time -->
            <div class="metric glass">
              <div class="metric-title">Avg Response Time</div>
              <div class="glass-body">
                <div class="glass-progress-bar">
                  <div id="avgRespBar" class="glass-progress-fill"></div>
                </div>
                <div class="glass-number"><span id="avgResponse">0.00</span> ms</div>
              </div>
            </div>

            <!-- Total Execution Time -->
            <div class="metric glass">
              <div class="metric-title">Total Time</div>
              <div class="glass-body">
                <div class="glass-progress-bar">
                  <div id="totalTimeBar" class="glass-progress-fill"></div>
                </div>
                <div class="glass-number" id="totalTime">0 ms</div>
              </div>
            </div>

            <!-- Sum of all Turnaround Times -->
            <div class="metric glass">
              <div class="metric-title">Sum Turnaround</div>
              <div class="glass-body">
                <div class="glass-progress-bar">
                  <div id="totalTATBar" class="glass-progress-fill"></div>
                </div>
                <div class="glass-number" id="totalTAT">0 ms</div>
              </div>
            </div>

          </div>
        </section>

      </main>
    </div>
  </div>

  <!-- ==================== ALGORITHM INFO MODAL ==================== -->
  <div id="algoModal" class="modal">
    <div class="modal-overlay" id="modalOverlay"></div>
    <div class="modal-content">
      <div class="modal-inner">
        <button class="modal-close" id="modalClose">‚úï</button>
        <h2 id="modalTitle" class="modal-title">Algorithm Overview</h2>
        <div class="modal-divider"></div>
        <p id="modalDescription" class="modal-text"></p>
      </div>
    </div>
  </div>

  <!-- ==================== EXTERNAL LIBRARIES ==================== -->
  <!-- SheetJS Library for Excel file parsing (.xlsx, .xls) -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
  
  <!-- PapaParse Library for CSV file parsing -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min.js"></script>
  
  <!-- Main JavaScript Logic -->
  <script src="scheduler.js"></script>
</body>
</html>